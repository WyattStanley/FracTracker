<!DOCTYPE html>
<html> 

<head>
  <meta charset="utf-8" />
  <meta name="description" content="Wyatt Stanley" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">

  <title>Wyatt Stanley</title>
  <!-- <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,400;0,500;1,400;1,500&display=swap" /> -->
  <!-- <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css"> -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"> -->
  <link rel="stylesheet" href="map.css">
  <script src="https://unpkg.com/scrollama"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>
</head>


<body>

    <div class="topnav" id="myTopnav">

        <!-- Links to other sections -->
        <a href="index.html">Home</a>
        <a class="active" href="pipe.html">Pipelines</a>
        <a href="Train2.html">Trains</a>
        <a href="water.html">Vessels</a>


        <!-- Additional links -->


        <!-- "Hamburger menu" / "Bar icon" to toggle the navigation links on smaller screens -->
        <a href="javascript:void(0);" class="icon">
            <i class="fa fa-bars"></i>
        </a>
    </div>

  <section id="cover">

    <style>
        .fullscreen-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
    
    <video class="fullscreen-video" playsinline="" autoplay="" muted="" loop="">
      <source src="video/Pipe.mp4" type="video/mp4">
    </video>

    <div id="intro">
      <h1>Pipelines</h1>
      <h5>Washington Fossil Fuel Spill Risk</h5>

      <div class="footnote">
        <!-- <span><a href="https://stock.adobe.com">Video Source</a></span> -->
      </div>
    </div>
  </section>
  <!-- a geonarrative will have two major components, a storyboard and a script panel of a series of scenes/actions -->
  <section id="geonarrative">
    <!-- a storymap can present differnt types of objects, like map, chart, diagram, etc. -->
    <div id="storyboard">
      <!-- create the place holder element for map -->
      <div id="map"></div>
    </div>

    <article class="scene" data-scene="0">
      <h2>1: Refineries</h2>
        <p>
          The red points displayed on this map are Washington facilities that are regulated by the Washington State Department of Ecology's Spills Program. 
          These points represent fixed shore-side facilities such as refineries and refueling terminals. This includes facilities that 
          transfer to or from tank vessels and pipelines. These facilities refine products such as Gas, Diesel, Crude Oil, Motor Oil, 
          Edible Oils, and more. 
          <br>
          <br>
          Oil pipelines transport crude oils and natural gas from several of these reinaries to other cities, states, coutries. If a 
          spill were to occur at one of these sites or during the transportation process 
          there could be severe effects on the following.
          <br>
        </p>
        <ul>
            <li>Populated residential areas and vulnurable communities.</li>
             <br>
            
            <li>Waterways that host culturally significant species and and habitat.</li>
             <br>
             
            <li>Wetlands and other natural ecosystems.</li> 
          </p>
        </ul>
        <p>
        Click on the points to display more infomation about these facilites and scroll down to learn more about the specific 
        refineries that are transporting oil by pipeline and the communities and environments they effect.
        <br>
        <br>
        This map includes <a href="https://apps.ecology.wa.gov/coastalatlas/storymaps/spills/spills_sm.html?&Tab=nt1">refinery facilities data</a>.

        </p>

        
    </article>
    <article class="scene" data-scene="1">
      <h2>2: Western WA Pipelines</h2>
        <p>
          <h3>Olympic Pipeline:</h3>
        </p>

        <ul>
          <li>"The Olympic Pipeline is a 400-mile interstate pipeline system that includes 12-inch, 14-inch, 16-inch, and 20-inch pipelines" 
            <a href="https://www.bp.com/en_us/united-states/home/products-and-services/pipelines.html">(BP).</a></li>
           <br>
          <li>"The pipeline runs along a 299-mile corridor from Blaine, Washington to Portland, Oregon" (BP).</li>
           <br>
          <li>"The system transports gasoline, diesel, and jet fuel" (BP).</li>
        </ul>  
        <p>
          <h3>Trans Mountain Pipeline:</h3>
        </p>
        <ul>
          <li>"The Trans Mountain Puget Sound Pipeline is a 111-kilometre (69-mile) pipeline system made up of 16- to 20-inch pipe" <a href="https://www.transmountain.com/news/2019/trans-mountains-puget-sound-pipeline-shipping-products-to-washington-state-refineries-since-1954">(TransMountain).</a></li>
           <br>
          <li>This system "...has been shipping Canadian crude oil products since 1954 to Washington state.." (TransMountain).</li>
           <br>
          <li>This system has "..the capacity for up to about 240,000 bpd (28,600 m3 per day) depending on petroleum types..." (TransMountain).</li>
        </ul>
        <p>
          This map displays the Olympic and Trans Mountain pipelines along with the refineries they conncected to. Click on the points to display additional information.
        </p>

        <p>
          This map includes <a href="https://apps.ecology.wa.gov/coastalatlas/storymaps/spills/spills_sm.html?&Tab=nt1">refinery data</a>, the olympic pipeline was based on 
          <a href="https://www.bp.com/content/dam/bp/country-sites/en_us/united-states/home/documents/products-and-services/pipelines/olympic-overview.pdf">this image</a>, 
          <a href="https://atlas.eia.gov/datasets/eia::crude-oil-pipelines/explore?location=47.376601%2C-120.396332%2C7.00">trans mountain data</a>, and 
          <a href="https://www.transmountain.com/product-destination">information</a> on the refineries the trans mountain pipeline connects to.
        </p>
    </article>
    <article class="scene" data-scene="2">
      <h2>3: Western WA Wetlands</h2>
        <p>
          Wetlands are an important evnironmental asset to Washington State. "Wetlands are among the most productive ecosystem in the 
          world, comparable to rain forests and coral reefs" <a href="https://www.epa.gov/wetlands/why-are-wetlands-important">EPA.</a> 
          <br>
          <br>
          This map displays all the wetlands in Washington that are within a half mile radius of the track. If a spill were to occur, these 
          are the wetlands that are at the highest risk of exposure to an oil spill.
          <br>
          <br>
        </p>
        <p>
          <h3>Olympic Pipeline:</h3>
        </p>
        <p>
          The Olympic pipeline runs south from Bellingham, to Vancover Washington and is within a half mile radius of <b>1,671</b> wetland areas 
          encompassing <b>21,761</b> square miles of land. 
        </p>
        <p>
          <h3>Trans Mountain Pipeline:</h3>
        </p>
        <p>
          The Trans Mountain pipeline runs into Bellingham Washington from Canada and is within a half mile radius of <b>502</b> wetland areas encompassing 
          <b>3,607</b> square miles of land.
          <br>
          <br>

          This map includes <a href="https://geo.wa.gov/datasets/02b250843e44485ea7d736b34fa80998_4/explore?location=47.630334%2C-120.819730%2C12.31">wetlands data.</a>
        </p>
        
    </article>

    <article class="scene" data-scene="3">
      <h2>4: Western WA Environmental Justice Areas</h2>
        <p>
          <p>
            Low income areas are at a higher risk of living in proximity to petroleum facilities. 
            Petroleum terminals built in low income areas contribute to "disproportionate exposure to pollution from  
            burning fossil fuels and chemicals leaching into the water table" <a href="https://www.climaterealityproject.org/blog/how-pipelines-fuel-climate-injustice#:~:text=According%20to%20the%20Southern%20Environmental,or%20belonging%20to%20racial%20or">(The Climate Reality Project).</a>. 
          </p>
          <ul>
            <li>"Factories like this oil refinery are a major source of air pollutants, including toxic metals, particulates, and many types of gases" <a href="https://scied.ucar.edu/image/oil-refineries-create-air-pollution#:~:text=Factories%20like%20this%20oil%20refinery,%2C%20benzenes%2C%20and%20others).">(Ucar).</a></li>
             <br>
            <li>These communities are subjected to spill risk during the transfer between vessel, refinery, and pipeline.</li>
             <br>
            <li>These refinaries and its pollutants dirrectly effect the health of these communities and their environment.</li>
          </ul>
          <p>
            This map contains Washington <a href="https://www.arcgis.com/apps/View/index.html?appid=359a365f28014151a1ce821dd6f6745c">low 
              income data</a> represented by the blue areas and red points that represent Washington petroleum refinaries that 
              connect to both the Olympic pipeline and Trans Mountain pipeline.
            <br>
            <br>
            Click the points to display refinery information and the blue areas to display the population percent that is considered low income.
            <br>
  
            
          </p>
        </p>
    </article>
    <article class="scene" data-scene="4">
      <h2>5: Western WA Tribal Lands</h2>
      <p>
        In Washinton State, there in an inequality in the location of petroleum refineres and their cooresponding pipelines. 
        <br>
        <br>
        Red points on this map display refineries, each of which provides oil to the Olympic and Trans Mountain pipeline. The green areas 
        show tribal lands. The location of these refineries are located beside two of Washingtons tribal lands. Spills 
        in these locations can have detrimental effects on shorelines sourounding these areas. 
        <br>
        <br>
        This map displays tribal land proximity to refinaries. Both tribal lands found here, Lummi and Swinomish, have experienced the effects of
        oil spills.
        <br>
        <br>
        This map includes <a href="https://www.arcgis.com/apps/View/index.html?appid=359a365f28014151a1ce821dd6f6745c">tribal lands data</a>.
      </p>
    </article>

    <article class="scene" data-scene="5">
      <h2>6: Eastern WA Pipeline</h2>
      <p>
        <h3>Northwest Pipeline:</h3>
      </p>
      <ul>
        <li>This is a 1,377-mile pipeline system. <a href="https://www.tcenergy.com/operations/natural-gas/gas-transmission-northwest-xpress-project/">(TC Energy)</a></li>
         <br>
        <li>This system has transported natural gas since 1962 (TC Energy).</li>
         <br>
        <li>This system transports oil from western Canada into Idaho, Washington, Oregon, and California.</li>
      </ul>  
      <p>
        <h3>Yellowstone & Chevron Pipeline:</h3>
      </p>
      <ul>
        <li>The Chevron pipeline is part of a <b>3,000</b> mile network that carrys <b>1.5</b> million barrels of oil equivalent, chemicals, and refined products
          every day <a href="https://www.chevron.com/what-we-do/energy/transportation/pipelines">(Chevron).</a>
        </li>
         <br>
        <li>The Chevron has a storage capcity of <b>~2.6</b> million barrels of product (Chevron).</li>
         <br>
        <li>The Yellowstone pipeline is <b>~709</b> mile long pipeline operated by Phillips 66 <a href="https://www.offshore-technology.com/marketdata/yellowstone-product-pipeline-the-us/?cf-view">(Yellowstone).</a></li>
         <br>
        <li>The Yellowstone pipeline has a maximum diameter of 10 inches that transports fossil fuels from Montana to Washington (Yellowstone).</li>
      </ul>  
      <p>
        This map displays the Northwest pipeline, the Chevron pipeline, and the Yellowstone pipeline along with the refineries they conncected to. Click on the points to display additional information.
      </p>

    </article>

    <article class="scene" data-scene="6">
      <h2>7: Eastern WA Wetlands</h2>
      <p>
        Wetlands are an important evnironmental asset to Washington State. "Wetlands are among the most productive ecosystem in the 
        world, comparable to rain forests and coral reefs" <a href="https://www.epa.gov/wetlands/why-are-wetlands-important">EPA.</a> 
        <br>
        <br>
        This map displays all the wetlands in Washington that are within a half mile radius of the track. If a spill were to occur, these 
        are the wetlands that are at the highest risk of exposure to an oil spill.
        <br>
        <br>
      </p>
      <p>
        <h3>Northwest Pipeline:</h3>
      </p>
      <p>
        The NorthWest Pipeline, running from Spokane south through Eastern Washington, is within a half mile radius of <b>89</b> wetland areas 
        encompassing <b>~1,176</b> square miles of wetland area.
      </p>
      <p>
        <h3>Yellowstone & Chevron Pipelines:</h3>
      </p>
      <p>
        Combined, the Yellowstone & Chevron Pipelines in Eastern Washington are within a half mile radius of <b>598</b> wetland areas encompassing 
        <b>~5,820</b> square miles of wetland area.
        <br>
        <br>
        This map includes <a href="https://geo.wa.gov/datasets/02b250843e44485ea7d736b34fa80998_4/explore?location=47.630334%2C-120.819730%2C12.31">wetlands data.</a>
      </p>

      


    </article>

    <article class="scene" data-scene="7">
      <h2>8: Eastern WA Environmental Justice Areas</h2>
      <p>
        <p>
          Low income areas are at a higher risk of living in proximity to petroleum facilities. 
          Petroleum terminals built in low income areas contribute to "disproportionate exposure to pollution from  
          burning fossil fuels and chemicals leaching into the water table" <a href="https://www.climaterealityproject.org/blog/how-pipelines-fuel-climate-injustice#:~:text=According%20to%20the%20Southern%20Environmental,or%20belonging%20to%20racial%20or">(The Climate Reality Project).</a>. 
        </p>
        <ul>
          <li>"Factories like this oil refinery are a major source of air pollutants, including toxic metals, particulates, and many types of gases" <a href="https://scied.ucar.edu/image/oil-refineries-create-air-pollution#:~:text=Factories%20like%20this%20oil%20refinery,%2C%20benzenes%2C%20and%20others).">(Ucar).</a></li>
           <br>
          <li>These communities are subjected to spill risk during the transfer between vessel, refinery, and pipeline.</li>
           <br>
          <li>These refinaries and its pollutants dirrectly effect the health of these communities and their environment.</li>
        </ul>
        <p>
          This map contains Washington <a href="https://www.arcgis.com/apps/View/index.html?appid=359a365f28014151a1ce821dd6f6745c">low 
            income data</a> represented by the blue areas and red points that represent Washington <a href="https://apps.ecology.wa.gov/coastalatlas/storymaps/spills/spills_sm.html?&Tab=nt1">refineries</a> that 
            connect to both the Chevron and Yellowstone pipelines.
          <br>
          <br>
          Click the points to display refinery information and the blue areas to display the population percent that is considered low income.
          <br>
        </p>
      </p>

      


    </article>


    <article class="scene" data-scene="8">
      <h2>9: Northwest Pipeline Expansion</h2>
      
        <p>
          On October 19th, 2023, the Federal Energy Regulatory Commission (FERC) allowed the proposed gas transmission northwest pipeline 
          to move forward with its expansion. This expansion will “…upgrade three existing compressor stations on the Gas Transmission 
          Northwest (GTN) system..." (TC Energy). The expansion of this project will allow for the pipeline to 
          transport <b>150,000</b> dekatherms of natural gas a day, enough gas to power <b>750,000</b> homes. This pipeline is expected to continue 
          at this rate for <b>50</b> years after its completion (Washington Governor Jay Inslee).
        </p>
        <ul>
          <li>Gov. Jay Inslee stated that <b>hundreds of millions</b> of dollars have been invested to achieve <b>100%</b> clean electricity by 2045 (Inslee, Jay).</li>
            <br>
          <li>If implemented, the GTN pipeline “...would represent <b>48</b> percent of the region’s target greenhouse gas emissions from all sources (Inslee, Jay).</li>
            <br>
          <li>If expanded, the GTN pipeline would continue to operate after Washington transitions to net zero emissions.</li>
            <br>
          <li>Due to the decline of gas sales in Washington State, GTN may not be able to recover their invested costs. “Those costs 
            will increasingly burden the remaining customers and GTN may be unable to revolver the costs, resulting in a stranded asset” 
            (Inslee, Jay).</li>
        </ul>
        
        <p>
          This map displays all the pump stations for this pipeline along with the three proposed pump stations.
  
  
          <a href="https://www.tcenergy.com/siteassets/pdfs/natural-gas/gas-transmission-northwest/tc-gas-transmission-northwest-map.pdf">NW Pipeline Based On</a>
          <a href="https://tcenergy.com/siteassets/pdfs/natural-gas/gtnxp/tce-gas-transmission-northwest-xpress-map.pdf">Commpressors Based On</a>
          <a href="https://www.researchgate.net/figure/3-WA-Department-of-Ecology-Marine-and-Pipeline-Routes-in-Puget-Sound-Region-Credit_fig1_268810713">Based On</a>
        </p>

      


    </article>

    <article class="scene" data-scene="9">
      <h2>10: Northwest Pipeline Rupture Risk</h2>
      <p>

      </p>


      <p>
        Not only does this pipeline expansion go against the climate goals and laws of Washington, Oregon, and California, but it introduces 
        unneeded risk to Washingtons communities and environments. 
        
      </p>

      <ul>
        <li>On April 16th, 2024 a section of TC Energy's (The company who is expanding the Northwest pipeline) NGTL gas pipline in Alberta burst and 
          caught on fire. This rupture sparked a forest fire in the remote area <a href="https://www.reuters.com/world/americas/tc-energy-gas-pipeline-triggers-wildfire-alberta-media-report-2024-04-16/">(Reuters).</a> </li>
        <br>
        <li>Similar ruptures in Washington would "...not only harm the environment but also present a heightened wildfire risk in the arid regions it passes 
          through".</li>
        <br>
        <li>“An explosion of that level in eastern Washington or eastern Oregon would be catastrophic” <a href="https://apnews.com/article/natural-gas-pipeline-pacific-northwest-5e9c79c412b407ddc9bcb21c1ff8ee26">(APN News).</a></li>
      </ul>

    </article>

    <article class="scene" data-scene="10">
      <h2>11: Olympic Spill</h2>
      <p>
        On December 12th, 2023, the Olympic pipeline ruptured near Washingtons Skagit River <a href="https://apnews.com/article/olympic-pipeline-spill-epa-washington-cab83ab6340386367bd6b3139c699816">(AP News).</a>
        <br>
        <br>
        "About <b>25,660</b> gallons (97,100 liters) of gasoline spilled after a small tube leading from the main Olympic Pipeline to a 
        pressure-check valve failed on Sunday..." (AP News).
        <br>
        <br>
        "The EPA said responders placed an absorbent boom downstream of the spill in Hill Ditch and Bulson Creek, which support salmon 
        and other wildlife and which flow into the Skagit River" (AP News). 
        <br>
        <br>
        This map displays where the Olypic Pipeline burst on December 12th, 2023.
      </p>

      


    </article>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>


  </section>

  <section id="footer">
    <h2>Wyatt Stanley</h2>
  </section>
  
  <script>
    // 1. Declare the maps, script panels, and different thematic layers.
    let map, scriptPanel = scrollama(), refineLayer, rolympicLayer, olympic2Layer, ysLayer, ys2Layer, tmLayer, tm2Layer, nwLayer, nw2Layer, owetLayer, yswetLayer, tmwetLayer, nwwetLayer, orfLayer, orf2Layer, ysrfLayer, tmrf2Layer, nwrfLayer, income, o_tribeLayer, pumpLayer;

    // 2. Intialize the layout.
   
    history.scrollRestoration = "manual"; // make sure the geo-narrative will be scrolled to the cover page even after a page refresh.
    window.scrollTo(0, 0); // scroll the geo-narrative to the coverpage
    adjustStoryboardlSize(); // force a browser window resize.
    window.addEventListener("resize", adjustStoryboardlSize); // // ask the browser window listen to the resize event, thereby force a viewport resize whenever adjusting the window size.

    // 3. Define Generic window resize listener event
    function adjustStoryboardlSize() {

      const scenes = document.getElementsByClassName("scene");
      const storyboard = document.getElementById("storyboard");

      // 3.1 determine the height of each scene element
      let sceneH = Math.floor(window.innerHeight * 0.75);
      for (const scene of scenes) {
        scene.style.height = sceneH + "px";
      }
      
      // 3.2 determin the height of the storyboard.
      let storyboardHeight = window.innerHeight;
      let storyboardMarginTop = (window.innerHeight - storyboardHeight) / 2;

      storyboard.style.height = storyboardHeight + "px";
      storyboard.style.top = storyboardMarginTop + "px"

      // 3.3 tell scrollama/script panel to update new element dimensions
      scriptPanel.resize();
    }

    // 4. Initialize the mapbox
    mapboxgl.accessToken =
      'pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw'; // Assign the access token
   
    map = new mapboxgl.Map({
      container: 'map', // container ID
      style: 'mapbox://styles/mapbox/light-v10',
      zoom: 7, // starting zoom
      minZoom: 3,
      maxZoom: 10,
      center: [-121.93, 47.33], // starting center
      scrollZoom: false,
      boxZoom: false,
      doubleClickZoom: false
    });  // Declare the map object

    // An alternative way to disable map zoom when using scroll
    // map.scrollZoom.disable();


    // 5. define the asynchronous function to load geojson data and then performs the dependent actions.
    async function geojsonFetch() {


      // 6 wait till the data of washington counties and celltowers are fully loaded.
      let response, refine, olympic, olympic2, ys, ys2, tm, tm2, nw, nw2, owet, yswet, tmwet, nwwet, orf, orf2, ysrf, tmrf, tmrf2, nwrf, income, o_tribe, pump;
      
      // ALL REFINARIES
      response = await fetch("assets/Water/refinaries.geojson");
      refine = await response.json();

      // PIPELINES

      response = await fetch("assets/Pipe/Olympic.geojson");
      olympic = await response.json();
      response = await fetch("assets/Pipe/Olympic.geojson");
      olympic2 = await response.json();
      response = await fetch("assets/Pipe/YS_pipeline.geojson");
      ys = await response.json();
      response = await fetch("assets/Pipe/YS_pipeline.geojson");
      ys2 = await response.json();
      response = await fetch("assets/Pipe/TM_pipeline.geojson");
      tm = await response.json();
      response = await fetch("assets/Pipe/TM_pipeline.geojson");
      tm2 = await response.json();
      response = await fetch("assets/Pipe/NW_Pipeline.geojson");
      nw = await response.json();
      response = await fetch("assets/Pipe/NW_Pipeline.geojson");
      nw2 = await response.json();

      // // WETLANDS
      response = await fetch("assets/Pipe/oly_wet.geojson");
      owet = await response.json();
      response = await fetch("assets/Pipe/ys_wet.geojson");
      yswet = await response.json();
      response = await fetch("assets/Pipe/tm_wet.geojson");
      tmwet = await response.json();
      response = await fetch("assets/Pipe/nw_wet.geojson");
      nwwet = await response.json();

      // // REFINARIES BY PIPELINE
      response = await fetch("assets/Pipe/refoil.geojson");
      orf = await response.json();
      response = await fetch("assets/Pipe/refoil.geojson");
      orf2 = await response.json();
      response = await fetch("assets/Pipe/ys_refine.geojson");
      ysrf = await response.json();
      response = await fetch("assets/Pipe/refoil.geojson");
      tmrf = await response.json();
      response = await fetch("assets/Pipe/refoil.geojson");
      tmrf2 = await response.json();
      response = await fetch("assets/Pipe/nw_com.geojson");
      nwrf = await response.json();

      //LOW INCOME
      response = await fetch("assets/Water/lowincome.geojson");
      income = await response.json();
      response = await fetch("assets/Pipe/o_tribe.geojson");
      o_tribe = await response.json();
      response = await fetch("assets/Pipe/update.geojson");
      pump = await response.json();
      





      // 7. Trigger operations inside of the the ()=> {} funciton while loading the map.
      map.on('load', () => {

        // 8. add map source and declare layers.

        // ALL REFINARIES

        map.addSource('refine-src', {
          type: 'geojson',
          data: refine
        });

        // PIPELINES

        map.addSource('olympic-src', {
          type: 'geojson',
          data: olympic
        });

        map.addSource('olympic2-src', {
          type: 'geojson',
          data: olympic2
        });

        map.addSource('ys-src', {
          type: 'geojson',
          data: ys
        });

        map.addSource('ys2-src', {
          type: 'geojson',
          data: ys2
        });

        map.addSource('tm-src', {
          type: 'geojson',
          data: tm
        });

        map.addSource('tm2-src', {
          type: 'geojson',
          data: tm2
        });

        map.addSource('nw-src', {
          type: 'geojson',
          data: nw
        });

        map.addSource('nw2-src', {
          type: 'geojson',
          data: nw2
        });

        // WETLANDS

        map.addSource('owet-src', {
          type: 'geojson',
          data: olympic
        });

        map.addSource('yswet-src', {
          type: 'geojson',
          data: yswet
        });

        map.addSource('tmwet-src', {
          type: 'geojson',
          data: tmwet
        });

        map.addSource('nwwet-src', {
          type: 'geojson',
          data: nwwet
        });

        // REFINARIES BY PIPELINE

        map.addSource('orf-src', {
          type: 'geojson',
          data: orf
        });

        map.addSource('orf2-src', {
          type: 'geojson',
          data: orf2
        });

        map.addSource('ysrf-src', {
          type: 'geojson',
          data: ysrf
        });

        map.addSource('tmrf-src', {
          type: 'geojson',
          data: tmrf
        });

        map.addSource('tmrf2-src', {
          type: 'geojson',
          data: tmrf2
        });

        map.addSource('nwrf-src', {
          type: 'geojson',
          data: nwrf
        });

        //LOW INCOME
        map.addSource('income-src', {
          type: 'geojson',
          data: income
        });

        map.addSource('o_tribe-src', {
          type: 'geojson',
          data: o_tribe
        });

        map.addSource('pump-src', {
          type: 'geojson',
          data: pump
        });







        //declare layers

        //ALL REFINARIES

        refineLayer = {
          'id': 'refine-points',
          'type': 'circle',
          'source': 'refine-src',
          'minzoom': 1,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 0.4,
          }
        };

        // PIPELINES
        olympicLayer = {
          'id': 'olympic-lines',
          'type': 'line',
          'source': 'olympic-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        olympic2Layer = {
          'id': 'olympic2-lines',
          'type': 'line',
          'source': 'olympic2-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        ysLayer = {
          'id': 'ys-lines',
          'type': 'line',
          'source': 'ys-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        ys2Layer = {
          'id': 'ys2-lines',
          'type': 'line',
          'source': 'ys2-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        tmLayer = {
          'id': 'tm-lines',
          'type': 'line',
          'source': 'tm-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
          
          }
        };

        tm2Layer = {
          'id': 'tm2-lines',
          'type': 'line',
          'source': 'tm2-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
          
          }
        };

        nwLayer = {
          'id': 'nw-lines',
          'type': 'line',
          'source': 'nw-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        nw2Layer = {
          'id': 'nw2-lines',
          'type': 'line',
          'source': 'nw2-src',
          'minzoom': 5,
          'paint': {
            'line-color': '#000000',
            'line-width': 1.5
            
          }
        };

        // WETLANDS
        owetLayer = {
          'id': 'owet-polygons',
          'type': 'fill',
          'source': 'owet-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#cc0000',
            'fill-opacity': 1

          }
        };

        yswetLayer = {
          'id': 'yswet-polygons',
          'type': 'fill',
          'source': 'yswet-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#cc0000',
            'fill-opacity': 1

          }
        };

        tmwetLayer = {
          'id': 'tmwet-polygons',
          'type': 'fill',
          'source': 'tmwet-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#cc0000',
            'fill-opacity': 1

          }
        };

        nwwetLayer = {
          'id': 'nwwet-polygons',
          'type': 'fill',
          'source': 'nwwet-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#cc0000',
            'fill-opacity': 1

          }
        };

        // REFINAREIS BY PIPELINE
        orfLayer = {
          'id': 'orf-points',
          'type': 'circle',
          'source': 'orf-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        orf2Layer = {
          'id': 'orf2-points',
          'type': 'circle',
          'source': 'orf2-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        ysrfLayer = {
          'id': 'ysrf-points',
          'type': 'circle',
          'source': 'ysrf-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        tmrfLayer = {
          'id': 'tmrf-points',
          'type': 'circle',
          'source': 'tmrf-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        tmrf2Layer = {
          'id': 'tmrf2-points',
          'type': 'circle',
          'source': 'tmrf2-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        nwrfLayer = {
          'id': 'nwrf-points',
          'type': 'circle',
          'source': 'nwrf-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#cc0000',
            'circle-radius': 5,
            'circle-opacity': 1,
          }
        };

        //LOW INCOME 

        incomeLayer = {
          'id': 'income-polygons',
          'type': 'fill',
          'source': 'income-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#0000ff',
            'fill-opacity': 0.2

          }
        };

        o_tribeLayer = {
          'id': 'o_tribe-polygons',
          'type': 'fill',
          'source': 'o_tribe-src',
          'minzoom': 5,
          'paint': {
            'fill-color': '#00cc00',
            'fill-opacity': 0.2

          }
        };

        pumpLayer = {
          'id': 'pump-points',
          'type': 'circle',
          'source': 'pump-src',
          'minzoom': 5,
          'paint': {
            'circle-color': '#00000',
            'circle-radius': 6,
            'circle-opacity': 1,
          }
        };



        // 9. Initialize the script panel
        scriptPanel
          .setup({
            step: ".scene", // all the scenes.
            offset: 0.33, // the location of the enter and exit trigger
            debug: false // toggler on or off the debug mode.
          })
          .onStepEnter(handleSceneEnter)
          .onStepExit(handleSceneExit);
        
        // 10. This function performs when a scene enters the storyboard
        function handleSceneEnter(response) {

          var index = response.index; // capture the id of the current scene. 

          // Refinaries
          
          if (index === 0) { // When enter the first scene

            map.flyTo({
              center: [-124.6, 47.6131229],
              zoom: 6.2,
              pitch: 0,
              speed: 0.5
            }); // fly to a new location
            
            if (typeof (map.getSource('refine-src')) == 'undefined') { //if the map source 'counties-src' does not exist
              map.addSource('refine-src', {
                type: 'geojson',
                data: refine
              }); // reload the map source of 'counties-src'
            } else {
              map.getSource('refine-src').setData(refine); // if the map source does not exist, relaod the data counties to the pre-defined map source 'counties-src'.

            }

            if (!map.getLayer("refine-points")) { // if the map layer 'counties-polygons' does not exit
              map.addLayer(refineLayer);
            }
            document.getElementById("cover").style.visibility = "hidden"; // Hide the cover page
        

            // Ports
          } else if (index === 1) { // When enter the second scene.
            map.flyTo({
              center: [-124.6, 47.6131229],
              zoom: 6.2,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('olympic-src')) == 'undefined') {
              map.addSource('olympic-src', {
                type: 'geojson',
                data: olympic
              });
            } else {
              map.getSource('olympic-src').setData(olympic);

            }

            if (!map.getLayer("olympic-lines")) {
              map.addLayer(olympicLayer);
            }

            if (typeof (map.getSource('tm-src')) == 'undefined') {
              map.addSource('tm-src', {
                type: 'geojson',
                data: tm
              });
            } else {
              map.getSource('tm-src').setData(tm);

            }

            if (!map.getLayer("tm-lines")) {
              map.addLayer(tmLayer);
            }

            if (typeof (map.getSource('orf-src')) == 'undefined') {
              map.addSource('orf-src', {
                type: 'geojson',
                data: orf
              });
            } else {
              map.getSource('orf-src').setData(orf);

            }

            if (!map.getLayer("orf-points")) {
              map.addLayer(orfLayer);
            }

            
          } else if (index === 2) {
            //Relocate to Seattle
            map.flyTo({
              center: [-122.8, 48.2],
              zoom: 9,
              pitch: 50,
              speed: 0.5
            });

            if (typeof (map.getSource('olympic2-src')) == 'undefined') {
              map.addSource('olympic2-src', {
                type: 'geojson',
                data: olympic2
              });
            } else {
              map.getSource('olympic2-src').setData(olympic2);

            }

            if (!map.getLayer("olympic2-lines")) {
              map.addLayer(olympic2Layer);
            }

            if (typeof (map.getSource('tm2-src')) == 'undefined') {
              map.addSource('tm2-src', {
                type: 'geojson',
                data: tm
              });
            } else {
              map.getSource('tm2-src').setData(tm2);

            }

            if (!map.getLayer("tm2-lines")) {
              map.addLayer(tm2Layer);
            }

            if (typeof (map.getSource('owet-src')) == 'undefined') {
              map.addSource('owet-src', {
                type: 'geojson',
                data: owet
              });
            } else {
              map.getSource('owet-src').setData(owet);

            }

            if (!map.getLayer("owet-polygons")) {
              map.addLayer(owetLayer);
            }

            if (typeof (map.getSource('tmwet-src')) == 'undefined') {
              map.addSource('tmwet-src', {
                type: 'geojson',
                data: tmwet
              });
            } else {
              map.getSource('tmwet-src').setData(tmwet);

            }

            if (!map.getLayer("tmwet-polygons")) {
              map.addLayer(tmwetLayer);
            }


          } else if (index === 3) { // When enter the second scene.
            map.flyTo({
              center: [-123, 48.7],
              zoom: 9,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('income-src')) == 'undefined') {
              map.addSource('income-src', {
                type: 'geojson',
                data: income
              });
            } else {
              map.getSource('income-src').setData(income);

            }

            if (!map.getLayer("income-polygons")) {
              map.addLayer(incomeLayer);
            }

            if (typeof (map.getSource('orf-src')) == 'undefined') {
              map.addSource('orf-src', {
                type: 'geojson',
                data: orf
              });
            } else {
              map.getSource('orf-src').setData(orf);

            }

            if (!map.getLayer("orf-points")) {
              map.addLayer(orfLayer);
            }

            
          } else if (index === 4) { // When enter the second scene.
            map.flyTo({
              center: [-123, 48.7],
              zoom: 9,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('o_tribe-src')) == 'undefined') {
              map.addSource('o_tribe-src', {
                type: 'geojson',
                data: o_tribe
              });
            } else {
              map.getSource('o_tribe-src').setData(o_tribe);

            }

            if (!map.getLayer("o_tribe-polygons")) {
              map.addLayer(o_tribeLayer);
            }

            if (typeof (map.getSource('orf2-src')) == 'undefined') {
              map.addSource('orf2-src', {
                type: 'geojson',
                data: orf
              });
            } else {
              map.getSource('orf2-src').setData(orf);

            }

            if (!map.getLayer("orf2-points")) {
              map.addLayer(orf2Layer);
            }

            
          } else if (index === 5) { // When enter the second scene.
            map.flyTo({
              center: [-119.7, 47],
              zoom: 7,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('ys-src')) == 'undefined') {
              map.addSource('ys-src', {
                type: 'geojson',
                data: ys
              });
            } else {
              map.getSource('ys-src').setData(ys);

            }

            if (!map.getLayer("ys-lines")) {
              map.addLayer(ysLayer);
            }

            if (typeof (map.getSource('nw-src')) == 'undefined') {
              map.addSource('nw-src', {
                type: 'geojson',
                data: nw
              });
            } else {
              map.getSource('nw-src').setData(nw);

            }

            if (!map.getLayer("nw-lines")) {
              map.addLayer(nwLayer);
            }

            if (typeof (map.getSource('orf-src')) == 'undefined') {
              map.addSource('ysrf-src', {
                type: 'geojson',
                data: ysrf
              });
            } else {
              map.getSource('ysrf-src').setData(ysrf);

            }

            if (!map.getLayer("ysrf-points")) {
              map.addLayer(ysrfLayer);
            }

            
          } else if (index === 6) {
            //Relocate to Seattle
            map.flyTo({
              center: [-118, 47.2],
              zoom: 10,
              pitch: 57,
              speed: 0.5
            });

            if (typeof (map.getSource('ys2-src')) == 'undefined') {
              map.addSource('ys2-src', {
                type: 'geojson',
                data: ys2
              });
            } else {
              map.getSource('ys2-src').setData(ys2);

            }

            if (!map.getLayer("ys2-lines")) {
              map.addLayer(ys2Layer);
            }

            if (typeof (map.getSource('nw2-src')) == 'undefined') {
              map.addSource('nw2-src', {
                type: 'geojson',
                data: nw2
              });
            } else {
              map.getSource('nw2-src').setData(nw2);

            }

            if (!map.getLayer("nw2-lines")) {
              map.addLayer(nw2Layer);
            }

            if (typeof (map.getSource('yswet-src')) == 'undefined') {
              map.addSource('yswet-src', {
                type: 'geojson',
                data: yswet
              });
            } else {
              map.getSource('yswet-src').setData(yswet);

            }

            if (!map.getLayer("yswet-polygons")) {
              map.addLayer(yswetLayer);
            }

            if (typeof (map.getSource('nwwet-src')) == 'undefined') {
              map.addSource('nwet-src', {
                type: 'geojson',
                data: nwwet
              });
            } else {
              map.getSource('nwwet-src').setData(nwwet);

            }

            if (!map.getLayer("nwwet-polygons")) {
              map.addLayer(nwwetLayer);
            }


          } else if (index === 7) {
            //Relocate to Seattle
            map.flyTo({
              center: [-119, 47],
              zoom: 7.7,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('income-src')) == 'undefined') {
              map.addSource('income-src', {
                type: 'geojson',
                data: income
              });
            } else {
              map.getSource('income-src').setData(income);

            }

            if (!map.getLayer("income-polygons")) {
              map.addLayer(incomeLayer);
            }

            if (typeof (map.getSource('ysrf-src')) == 'undefined') {
              map.addSource('ysrf-src', {
                type: 'geojson',
                data: ysrf
              });
            } else {
              map.getSource('ysrf-src').setData(ysrf);

            }

            if (!map.getLayer("ysrf-points")) {
              map.addLayer(ysrfLayer);
            }


          } else if (index === 8) { // When enter the second scene.
            map.flyTo({
              center: [-123, 46],
              zoom: 6.2,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('nw-src')) == 'undefined') {
              map.addSource('nw-src', {
                type: 'geojson',
                data: nw
              });
            } else {
              map.getSource('nw-src').setData(nw);

            }

            if (!map.getLayer("nw-lines")) {
              map.addLayer(nwLayer);
            }

            if (typeof (map.getSource('nwrf-src')) == 'undefined') {
              map.addSource('nwrf-src', {
                type: 'geojson',
                data: nwrf
              });
            } else {
              map.getSource('nwrf-src').setData(nwrf);

            }

            if (!map.getLayer("nwrf-points")) {
              map.addLayer(nwrfLayer);
            }

            if (typeof (map.getSource('pump-src')) == 'undefined') {
              map.addSource('pump-src', {
                type: 'geojson',
                data: pump
              });
            } else {
              map.getSource('pump-src').setData(pump);

            }

            if (!map.getLayer("pump-points")) {
              map.addLayer(pumpLayer);
            }



            
          } else if (index === 9) { // When enter the second scene.
            map.flyTo({
              center: [-123, 46],
              zoom: 6.2,
              pitch: 0,
              speed: 0.5
            });

            if (typeof (map.getSource('nw2-src')) == 'undefined') {
              map.addSource('nw2-src', {
                type: 'geojson',
                data: nw2
              });
            } else {
              map.getSource('nw2-src').setData(nw2);

            }

            if (!map.getLayer("nw2-lines")) {
              map.addLayer(nw2Layer);
            }

            if (typeof (map.getSource('nwwet-src')) == 'undefined') {
              map.addSource('nwet-src', {
                type: 'geojson',
                data: nwwet
              });
            } else {
              map.getSource('nwwet-src').setData(nwwet);

            }

            if (!map.getLayer("nwwet-polygons")) {
              map.addLayer(nwwetLayer);
            }

            
          } else if (index === 14) {

            map.flyTo({
              center: [-122.4121036, 47.6131229],
              zoom: 7,
              pitch: 0,
              speed: 0.5

            });


          }



        }

        

        // 11. This function performs when a scene exists the storyboard
        function handleSceneExit(response) {
          var index = response.index;

          if (index === 0) {
            if (map.getLayer("refine-points")) {
              map.removeLayer('refine-points');
            }
            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 1) {
            if (map.getLayer("olympic-lines")) {
              map.removeLayer('olympic-lines');
            }
            if (map.getLayer("tm-lines")) {
              map.removeLayer('tm-lines');
            }
            if (map.getLayer("orf-points")) {
              map.removeLayer('orf-points');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 2) {
            if (map.getLayer("olympic2-lines")) {
              map.removeLayer('olympic2-lines');
            }
            if (map.getLayer("owet-polygons")) {
              map.removeLayer('owet-polygons');
            }
            if (map.getLayer("tm2-lines")) {
              map.removeLayer('tm2-lines');
            }
            if (map.getLayer("tmwet-polygons")) {
              map.removeLayer('tmwet-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 
 
          } else if (index === 3) {
            if (map.getLayer("orf-points")) {
              map.removeLayer('orf-points');
            }
            if (map.getLayer("income-polygons")) {
              map.removeLayer('income-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 4) {
            if (map.getLayer("orf2-points")) {
              map.removeLayer('orf2-points');
            }
            if (map.getLayer("o_tribe-polygons")) {
              map.removeLayer('o_tribe-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 5) {
            if (map.getLayer("ys-lines")) {
              map.removeLayer('ys-lines');
            }
            if (map.getLayer("nw-lines")) {
              map.removeLayer('nw-lines');
            }
            if (map.getLayer("ysrf-points")) {
              map.removeLayer('ysrf-points');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 6) {
            if (map.getLayer("ys2-lines")) {
              map.removeLayer('ys2-lines');
            }
            if (map.getLayer("nw2-lines")) {
              map.removeLayer('nw2-lines');
            }
            if (map.getLayer("yswet-polygons")) {
              map.removeLayer('yswet-polygons');
            }
            if (map.getLayer("nwwet-polygons")) {
              map.removeLayer('nwwet-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 7) {
            if (map.getLayer("ysrf-points")) {
              map.removeLayer('ysrf-points');
            }
            if (map.getLayer("income-polygons")) {
              map.removeLayer('income-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 8) {
            if (map.getLayer("nw-lines")) {
              map.removeLayer('nw-lines');
            }
            if (map.getLayer("nwrf-points")) {
              map.removeLayer('nwrf-points');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          } else if (index === 9) {
            if (map.getLayer("nw2-lines")) {
              map.removeLayer('nw2-lines');
            }
            if (map.getLayer("nwwet-polygons")) {
              map.removeLayer('nwwet-polygons');
            }

            if (response.direction == 'down') { 
              document.getElementById("cover").style.visibility = "hidden"; // when you scroll down, the cover page will be hided.
            } else {
              document.getElementById("cover").style.visibility = "visible"; // when you scroll up, the cover page will be shown.
            } 

          }
        
        }
        });

    };
    // Define a popup variable for tribal and wetland data
    
    let refinePopup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });
    
    let vspillPopup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });

    let portsPopup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });

    let ports2Popup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });

    let trafficPopup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });

    let full_tribalPopup = new mapboxgl.Popup({
      closeButton: true,
      closeOnClick: true
    });

    

    // SPILLS
    map.on('click', 'vspill-points', function(e) {
      let feature = e.features[0];
      let popupContent = `<h3>${feature.properties.CaseName}</h3>
                          <p>Date: ${feature.properties.Date_incid}</p>
                          <p>Vessel Type: ${feature.properties.Source}</p>
                          <p>Oil Type: ${feature.properties.Oil_type}</p>`;
      vspillPopup.setLngLat(e.lngLat).setHTML(popupContent).addTo(map);
    });

    map.on('mouseenter', 'vspill-points', function() {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'vspill-points', function() {
      map.getCanvas().style.cursor = '';
    });

    // REFINARIES
    map.on('click', 'refine-points', function(e) {
      let feature = e.features[0];
      let popupContent = `<h3>${feature.properties.FacilityNa}</h3>
                          <p>Oil Type: ${feature.properties.OilProduct}</p>`;
      refinePopup.setLngLat(e.lngLat).setHTML(popupContent).addTo(map);
    });

    map.on('mouseenter', 'refine-points', function() {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'refine-points', function() {
      map.getCanvas().style.cursor = '';
    });


    // Ports
    map.on('click', 'ports-points', function(e) {
      let feature = e.features[0];
      let popupContent = `<h3>${feature.properties.NAME}</h3>
                          <p>Oil Type: ${feature.properties.TYPE}</p>`;
      portsPopup.setLngLat(e.lngLat).setHTML(popupContent).addTo(map);
    });

    map.on('mouseenter', 'ports-points', function() {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'ports-points', function() {
      map.getCanvas().style.cursor = '';
    });

    map.on('click', 'ports2-points', function(e) {
      let feature = e.features[0];
      let popupContent = `<h3>${feature.properties.NAME}</h3>
                          <p>Oil Type: ${feature.properties.TYPE}</p>`;
      ports2Popup.setLngLat(e.lngLat).setHTML(popupContent).addTo(map);
    });

    map.on('mouseenter', 'ports2-points', function() {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'ports2-points', function() {
      map.getCanvas().style.cursor = '';
    });


    // Traffic
    map.on('click', 'traffic-polygons', function(e) {
      let feature = e.features[0];
      let popupContent = `<h3>2020 Vessel Traffic</h3>`;

      trafficPopup.setLngLat(e.lngLat).setHTML(popupContent).addTo(map);
    });

    map.on('mouseenter', 'traffic-polygons', function() {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'traffic-polygons', function() {
      map.getCanvas().style.cursor = '';
    });





    const nav = new mapboxgl.NavigationControl();
    map.addControl(nav, 'top-right');





    // 5 call the data loading function.
    geojsonFetch();
  </script>
</body>


</html>

  